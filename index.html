<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
  <title>Lim Poh Poh & Teoh Wei Quan Wedding Invitation</title>
  <link rel="stylesheet" href="./public/css/zepto.fullpage.css">
  <link rel="stylesheet" href="./public/css/animate.css">
  <link rel="stylesheet" href="./public/css/index.css">
  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
  <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
  <style type="text/css">
    #loading-mask {
      width: 100%;
      height: 100%;
      position: absolute;
      left: 0;
      top: 0;
      background-color: #e2ecf5;
      z-index: 99;
    }

    .loading-box {
      position: absolute;
      top: 50%;
      left: 50%;
      margin-left: -150px;
      margin-top: -150px;
      display: block;
      width: 300px;
      height: 300px;
      border-radius: 3px;
      font-size: 30px;
      color: rgba(64, 158, 255, .5);
      text-align: center;
    }

    .loading-box p {
      font-size: 16px;
      margin: 16px 0;
    }

    .loading:before,
    .loading:after,
    .loading {
      display: inline-block;
      width: 1em;
      height: 1em;
      color: inherit;
      vertical-align: middle;
      pointer-events: none;
      border-radius: 50%;
      -webkit-animation-fill-mode: both;
      animation-fill-mode: both;
      -webkit-animation: loading 1.8s infinite ease-in-out;
      animation: loading 1.8s infinite ease-in-out;
    }

    .loading {
      color: currentcolor;
      position: relative;
      -webkit-transform: translateZ(0);
      transform: translateZ(0);
      -webkit-animation-delay: -0.16s;
      animation-delay: -0.16s;
      top: -1em;
    }

    .loading:before {
      right: 100%;
      -webkit-animation-delay: -0.32s;
      animation-delay: -0.32s;
    }

    .loading:after {
      left: 100%;
    }

    .loading:before,
    .loading:after {
      content: '';
      display: block;
      position: absolute;
      top: 0;
      width: inherit;
      height: inherit;
    }

    @-webkit-keyframes loading {

      0%,
      80%,
      100% {
        box-shadow: 0 1em 0 -1em;
      }

      40% {
        box-shadow: 0 1em 0 -.2em;
      }
    }

    @keyframes loading {

      0%,
      80%,
      100% {
        box-shadow: 0 1em 0 -1em;
      }

      40% {
        box-shadow: 0 1em 0 -.2em;
      }
    }

    .load-img {
      visibility: hidden;
    }
  </style>
  <script type="text/javascript">
    var loadSum = 0
    var isMobile = false; 

    function loadDone() {
      loadSum++
    }

    function pcTip() {
      if ((navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i))) {
        console.log('mobile')
        isMobile = true
      } else {
        console.log('pc')
        loadSum = loadSum - 10
        isMobile = false
	      document.getElementById('map').style.display = 'none';
        document.getElementById('loading-txt').innerHTML = '请使用手机或其它移动设备打开!'
      }
    } 

    pcTip();
  </script>
</head>

<body>
  <div id="loading-mask">
    <div class="loading-box">
      <div class="loading"></div>
      <p id="loading-txt">Loading</p>
    </div>
  </div>
  <div id="play-btn"><i class="iconfont" style="font-size: 20px;">&#xe617;</i></div>
  <img class="load-img" onload="loadDone();pcTip()" src="./public/photo/1.jpg">
  <img class="load-img" onload="loadDone()" src="./public/photo/2.jpg">
  <img class="load-img" onload="loadDone()" src="./public/photo/3.jpg">
  <img class="load-img" onload="loadDone()" src="./public/photo/4.jpg">
  <img class="load-img" onload="loadDone()" src="./public/photo/6.jpg">
  <img class="load-img" onload="loadDone()" src="./public/photo/7.jpg">
  <img class="load-img" onload="loadDone()" src="./public/photo/8.jpg">
  <img class="load-img" onload="loadDone()" src="./public/photo/9.jpg">
  <img class="load-img" onload="loadDone()" src="./public/photo/10.jpg">
  <img class="load-img" onload="loadDone()" src="./public/photo/11.jpg">
  <img class="load-img" onload="loadDone()" src="./public/photo/12.jpg">
  <img class="load-img" onload="loadDone()" src="./public/photo/13.jpg">
  <img class="load-img" onload="loadDone()" src="./public/photo/14.jpg">
  <img class="load-img" onload="loadDone()" src="./public/photo/15.jpg">
  <img class="load-img" onload="loadDone()" src="./public/photo/16.jpg">
  <img class="load-img" onload="loadDone()" src="./public/photo/17.jpg">
  <img class="load-img" onload="loadDone()" src="./public/photo/18.jpg">
  <div class="wp">
    <div class="wp-inner">
      <div class="page page1">
        <div class="photo-wrap">
          <div class="full-bg js-animate animated animation-8000"
            style="background-image: url(./public/photo/1.jpg); width: 100%; height: 100%; position: absolute; top:0; left: 0;"
            data-sec="zoomCycle" data-time="0">
          </div>
          <div class="text-frame js-animate animated" data-animate="rotateIn" data-time="500"></div>
          <div class="text-frame js-animate animated" data-animate="rotateIn" data-time="1200" data-sec="pulseing" data-sectime="1200"></div>
        </div>
        <div class="ele-wrap">
          <h4 class="js-animate animated animation-500" data-animate="bounceInDown" data-time="500" data-sec="zoomOut"
            data-sectime="700" style="position: absolute; top: 40%; width: 100%; text-align: center;">Ready</h4>
          <h4 class="js-animate animated animation-500" data-animate="bounceInRight" data-time="1500" data-sec="bounceOutUp"
            data-sectime="500" style="position: absolute; top: 40%; left: 15%">Ready</h4>
          <h4 class="js-animate animated animation-500" data-animate="bounceInLeft" data-time="1500" data-sec="bounceOutDown"
            data-sectime="500" style="position: absolute; top: 40%; right: 15%">Are you ready?</h4>
      
          <div class="js-animate animated animation-500" data-animate="bounceInDown" data-time="2500"
            data-sec="rotateOutDownLeft" data-sectime="500" style="position: absolute; top: 40%; width: 100%; text-align: center;">
            <h4>This</h4>
            <h4 style="margin-top: 10%;">is a</h4>
          </div>
          <h4 class="js-animate animated animation-500" data-animate="swing" data-time="3000" data-sec="zoomOutDown"
            data-sectime="500" style="position: absolute; top: 20%; width: 100%; text-align: center;">
            Sweet
          </h4>
          <h4 class="js-animate animated animation-500" data-animate="swing" data-time="3500" data-sec="fadeOutUpBig"
            data-sectime="500" style="position: absolute; top: 30%; width: 100%; text-align: center;">
            Wedding
          </h4>
          <h4 class="js-animate animated animation-500" data-animate="swing" data-time="3500" data-sec="fadeOutDownBig"
            data-sectime="500" style="position: absolute; top: 40%; width: 100%; text-align: center;">
            Invitation
          </h4>
          <h4 class="js-animate animated animation-500" data-animate="fadeInUp" data-time="4000" data-sec="fadeOutUp"
            data-sectime="500" style="position: absolute; top: 35%; width: 100%; text-align: center;">
            Dear Guests,
          </h4>
      
          <h4 class="js-animate animated animation-500" data-animate="myzoomIn" data-time="4500" data-sec="zoomOut"
            data-sectime="3600" style="position: absolute; top: 25%; left: 18%; text-align: center;">
            Aunt
          </h4>
          <h4 class="js-animate animated animation-500" data-animate="myzoomIn" data-time="4700" data-sec="zoomOut"
            data-sectime="3400" style="position: absolute; top: 35%; right: 20%; text-align: center;">
            Uncle
          </h4>
          <h4 class="js-animate animated animation-600" data-animate="bounceInDown" data-time="8000" data-sec="zoomOut"
            data-sectime="1500" style="position: absolute; top: 30%; width: 100%; text-align: center;">
            Sincere
          </h4>
          <h4 class="js-animate animated animation-600" data-animate="bounceInUp" data-time="8500" data-sec="zoomOut"
            data-sectime="1000" style="position: absolute; top: 45%; width: 100%; text-align: center;">
            Invitation
          </h4>
          <h4 class="js-animate animated animation-600" data-animate="zoomInLeft" data-time="9500" data-sec="slideOutUp"
            data-sectime="1100" style="position: absolute; top: 30%; width: 100%; text-align: center;">
            You
          </h4>
          <h4 class="js-animate animated animation-600" data-animate="zoomInLeft" data-time="10000" data-sec="slideOutDown"
            data-sectime="600" style="position: absolute; top: 45%; width: 100%; text-align: center;">
            and Your Family
          </h4>
          <h3 class="js-animate animated animation-500" data-animate="bounceInUp" data-time="11000" data-sec="zoomOutDown"
            data-sectime="600" style="position: absolute; top: 20%; width: 100%; text-align: center; letter-spacing: 3px; line-height: 40px;">
            Are Invited<br>To Our Wedding
          </h3>
          <h2 class="js-animate animated" data-animate="bounceInDown" data-time="12500"
            style="position: absolute; top: 28%; width: 100%; text-align: center; font-size: 32px; font-weight: 500;">
            We<br>Are<br>Getting<br>Married!
          </h2>
        </div>
      </div>
      

      <div class="page page2">
        <div class="photo-wrap">
          <div class="full-bg js-animate animated animation-1000"
            style="background-image: url(./public/photo/1.jpg); width: 100%; height: 100%;" data-animate="myzoomIn">
          </div>
        </div>
        <div class="ele-wrap">
          <div class="js-animate animated" data-animate="bounceInDown" data-time="0"
            style="position: absolute; top: 60%; width: 80%; left: 15%; text-align: center;">
            <img style="max-width: 100%;" src="./public/meta/wedding_white.png">
          </div>
          <div style="position: absolute; top: 69%; left: 0; width: 100%; text-align: center; height: 20%;">
            <img class="js-animate animated animation-1000" data-animate="minzoomCycle" data-time="500"
              src="./public/meta/hun_white.png" style="position: absolute; left: 15%;">
            <img class="js-animate animated animation-1000" data-animate="minzoomCycle" data-time="600"
              src="./public/meta/li_white.png" style="position: absolute; left: 30%;">
            <img class="js-animate animated animation-1000" data-animate="minzoomCycle" data-time="700"
              src="./public/meta/yao_white.png" style="position: absolute; left: 44%; top: 5%;">
            <img class="js-animate animated animation-1000" data-animate="minzoomCycle" data-time="800"
              src="./public/meta/qing_white.png" style="position: absolute; left: 56%; top: 5%;">
            <img class="js-animate animated animation-1000" data-animate="minzoomCycle" data-time="900"
              src="./public/meta/han_white.png" style="position: absolute; left: 69%; top: 5%;">
          </div>
          <div class="js-animate animated animation-500 radius-box" data-animate="rotateIn" data-time="1500"
            style="position: absolute; top: 80%; text-align: center;">
          </div>
          <div class="js-animate animated animation-500 radius-box" data-animate="rotateIn" data-time="2000"
            style="position: absolute; top: 80%; text-align: center;">
            <div class="js-animate animated animation-500" data-animate="fadeInRight" data-time="2500"
              style="position: absolute; left: 10%; color: #ffffff;">
              Lim Poh Poh
            </div>
            <div class="js-animate animated animation-500" data-animate="fadeInLeft" data-time="2500"
              style="position: absolute; right: 10%; color: #ffffff;">
              Teoh Wei Quan
            </div>
            <div class="js-animate animated animation-800 circle-box" data-animate="myzoomIn" data-time="3000"
              data-sec="shake" data-sectime="800">
              <img src="./public/meta/zuanshi.png">
            </div>
          </div>
          <div class="js-animate animated" data-animate="bounceInUp" data-time="3800"
            style="position: absolute; top: 88%; left: 0; width: 100%; text-align: center; color: #ffffff; font-size: 14px;">
            Welcome to our wedding on July 26th!
          </div>
          <div class="js-animate animated animation-2000" data-animate="zoomIn" data-time="5000"
            style="position: absolute; top: 95%; left: 0; width: 100%; text-align: center;">
            <img src="./public/meta/invitation_white.png" style="max-width: 75%;">
          </div>
        </div>
      </div>
      

      <div class="page page3" style="position: relative;">
        <div id="map" style="width: 100%; height: 300px;"></div>
      
        <div id="map-msg" style="text-align: center;  padding: 10px;margin: 0 auto;">
          <p class="js-animate animated" data-animate="fadeInUp" data-time="500" style="font-size: 22px; font-weight: bold;">
            You’re Invited to Our Happily Ever After!✨✨
          </p>
          <p class="js-animate animated" data-animate="fadeInUp" data-time="1000">
            The best moments in life are meant to be shared, and our wedding day wouldn’t be complete without you!
          </p>
          <p class="js-animate animated" data-animate="fadeInUp" data-time="1500">
            With hearts full of love and excitement, we invite you to celebrate this beautiful journey with us.💕
          </p>
      
          <p class="js-animate animated" data-animate="fadeIn" data-time="2500" style="margin-top: 10px;">
            📅 <b>Date:</b> 26th July 2025 <br>
            ⏰ <b>Time:</b> 7:00 PM <br>
            📍 <b>Venue:</b> W Factory Event Space
          </p>
      
          <p class="js-animate animated" data-animate="fadeInUp" data-time="3000" style="margin-top: 20px;">
            We have thoughtfully arranged a special seat just for you. Kindly remain in your assigned seat and please do not swap or take another guest’s place to ensure everyone enjoys a smooth and comfortable celebration.
          </p>
      
          <p class="js-animate animated" data-animate="fadeInUp" data-time="4000" style="font-size: 20px; font-weight: bold;">
            Your presence is our greatest gift, and we can’t wait to celebrate with you.😊😊
          </p>
      
          <p class="js-animate animated" data-animate="fadeInUp" data-time="4500">
            Kindly RSVP by <b>31st March 2025</b> at <b>013-416 9314</b>.
          </p>
      
          <p class="js-animate animated" data-animate="fadeInUp" data-time="5000" style="font-size: 22px; font-weight: bold;">
            Let the countdown to forever begin!
          </p>
      
          <p class="js-animate animated" data-animate="fadeInUp" data-time="5500" style="margin-top: 10px;">
            With love,<br>
            <b>Lim Poh Poh & Teoh Wei Quan</b>
          </p>
        </div>
      </div>
      
    </div>
    <span class="start"><i class="iconfont" style="color: #fff;font-size: 30px;">&#xe606;</i></span>
    <audio id="mp3" src="./public/music/music.mp3" autoplay loop></audio>
    <script>
      document.addEventListener("DOMContentLoaded", function () {
        function start() {
          clearInterval(loadTimer);

          setTimeout(() => {
            document.getElementById('loading-mask').style.display = 'none';
            
            // Initialize map only after loading screen disappears
            if (isMobile) {
              var map = L.map('map').setView([3.123456, 101.654321], 15);
              
              L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                attribution: '&copy; OpenStreetMap contributors'
              }).addTo(map);

              L.marker([3.123456, 101.654321]).addTo(map)
                .bindPopup('<b>W Factory Event Space</b><br>Kuala Lumpur')
                .openPopup();
            }
          }, 500); // Delay slightly to ensure smooth transition
        }

        if (isMobile !== false) {
          var loadTimer = setInterval(() => {
            console.log(loadSum);
            if (loadSum >= 17) {
              start(); // Call `start()` only when loading is complete
            }
          }, 300);
        }
      });

    </script>
    
    <script src="./public/js/js.fullpage.js"></script>
    <script type="text/javascript"
      src="https://api.map.baidu.com/api?v=2.0&ak=S6EO9oPso0n8aTMvfH1g0aLUX6vGZx1l"></script>
    <script>
      // 滚屏动画控制

      if (isMobile !== false) {
        var loadTimer = setInterval(() => {
          console.log(loadSum)
          if (loadSum >= 17) {
            start()
          }
        }, 300);
      }

      var domLists = []
      var mapFlag = false

      function start() {
        clearInterval(loadTimer);

        var forEach = [].forEach;

        setTimeout(() => {
          document.getElementById('loading-mask').style.display = 'none'
        }, 100);
        document.getElementsByClassName('wp-inner')[0].fullpage({
          change: function (e) {
            clearTime()
            // 移除动画属性
            forEach.call(document.querySelectorAll('.page')[e.cur].querySelectorAll('.js-animate'), function (v) {
              v.classList.add('hide');
              v.classList.remove(v.dataset['animate']);
              if (v.dataset['sec']) {
                v.classList.remove(v.dataset['sec']);
              }
            });
          },
          afterChange: function (e) {
            if (e.cur === 5 && !mapFlag) {
              initMap()
            }

            domLists = document.querySelectorAll('.page')[e.cur].querySelectorAll('.js-animate')
            forEach.call(domLists, v => {
              var time = v.dataset.time;
              v.timer = setTimeout(function () {
                v.classList.add(v.dataset['animate']);
                v.classList.remove('hide');
                if (v.dataset['sec']) {
                  var time = v.dataset.sectime || 0
                  v.sectimer = setTimeout(function () {
                    v.classList.remove(v.dataset['animate']);
                    v.classList.add(v.dataset['sec']);
                  }, time);
                }
              }, time);
            })
          }
        });
      }

      function clearTime() {
        domLists.forEach((dom, i, arr) => {
          if (dom.timer) {
            clearTimeout(dom.timer);
          }
          if (dom.sectimer) {
            clearTimeout(dom.sectimer);
          }
          if (arr && arr.splice) {
            arr.splice(i, 1)
          }
        })
      }

      // 地图
      function initMap() {
        if (window.BMap) {
          mapFlag = true
          var mapCenter = [104.083002, 30.5621]
          var map = new BMap.Map("map", { minZoom: 10, maxZoom: 14 })

          map.centerAndZoom(new BMap.Point(mapCenter[0], mapCenter[1]), 13);

          function ComplexCustomOverlay(point, text, mouseoverText) {
            this._point = point;
            this._text = text;
            this._overText = mouseoverText;
          }
          ComplexCustomOverlay.prototype = new BMap.Overlay();
          ComplexCustomOverlay.prototype.initialize = function (map) {
            this._map = map;
            var div = this._div = document.createElement("div");
            div.style.position = "absolute";
            div.style.zIndex = BMap.Overlay.getZIndex(this._point.lat);
            div.style.backgroundColor = "#E60000";
            div.style.borderRadius = "3px";
            div.style.color = "white";
            div.style.height = "18px";
            div.style.padding = "2px 4px";
            div.style.lineHeight = "18px";
            div.style.whiteSpace = "nowrap";
            div.style.MozUserSelect = "none";
            div.style.fontSize = "12px"
            var span = this._span = document.createElement("span");
            div.appendChild(span);
            span.appendChild(document.createTextNode(this._text));
            var that = this;

            var arrow = this._arrow = document.createElement("div");
            // arrow.style.background = "url(http://map.baidu.com/fwmap/upload/r/map/fwmap/static/house/images/label_white.png) no-repeat";
            arrow.style.position = "absolute";
            arrow.style.width = "0";
            arrow.style.height = "0";
            arrow.style.top = "22px";
            arrow.style.left = "10px";
            arrow.style.overflow = "hidden";
            arrow.style.border = "6px solid transparent";
            arrow.style.borderTop = "6px solid #E60000";
            div.appendChild(arrow);

            map.getPanes().labelPane.appendChild(div);

            return div;
          }
          ComplexCustomOverlay.prototype.draw = function () {
            var map = this._map;
            var pixel = map.pointToOverlayPixel(this._point);
            this._div.style.left = pixel.x - parseInt(this._arrow.style.left) + "px";
            this._div.style.top = pixel.y - 30 + "px";
          }

          var myCompOverlay = new ComplexCustomOverlay(new BMap.Point(mapCenter[0], mapCenter[1]), "婚礼", "N and Y");

          map.addOverlay(myCompOverlay);

          document.querySelector('#location-btn').addEventListener('click', () => {
            map.panTo(new BMap.Point(mapCenter[0], mapCenter[1]))
          })
        }
      }

      // 音乐播放控制
      window.onload = function () {
        let mp3 = document.querySelector('#mp3')
        let playBtn = document.querySelector('#play-btn')
        let play

        mp3.load()

        document.addEventListener("WeixinJSBridgeReady", function () {
          mp3.play()
          if (!mp3.paused) {
            this.style.animationPlayState = 'running'
            mp3.play()
            play = true
          }
        }, false)

        play = !mp3.paused && mp3.readyState === 4

        if (play) {
          playBtn.style.animationPlayState = 'running'
        } else {
          playBtn.style.animationPlayState = 'paused'
        }

        playBtn.addEventListener('click', function (event) {
          if (play) {
            this.style.animationPlayState = 'paused'
            mp3.pause()
            play = false
          } else {
            if (mp3.readyState === 4) {
              this.style.animationPlayState = 'running'
              mp3.play()
              play = true
            }
          }
        })
      }
    </script>
</body>

</html>